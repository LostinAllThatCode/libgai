\hypertarget{hotreload_0Cwin32_0Cmain_8cpp-example}{}\section{hotreload\textbackslash{}win32\textbackslash{}main.\+cpp}
{\bfseries Example\+: win32 \hyperlink{gai__hotreload_8h}{gai\+\_\+hotreload.\+h}}$\ast$


\begin{DoxyCodeInclude}
\textcolor{preprocessor}{#define GAIHR\_IMPLEMENTATION}
\textcolor{preprocessor}{#include "\hyperlink{gai__hotreload_8h}{gai\_hotreload.h}"}
\textcolor{preprocessor}{#include <stdio.h>}
\textcolor{preprocessor}{#include <stdlib.h>}

\textcolor{keyword}{volatile} \textcolor{keywordtype}{int} running = 1; \textcolor{comment}{// This will be changed by another thread!}

\hyperlink{gai__hotreload_8h_a6f8c5bfe220445bbbb8e1c9ef176838a}{GAIHR\_CALLBACK}(printFileContentAndStop)
\{
    \textcolor{keywordtype}{long} filesize = 0;
    \textcolor{keywordtype}{char} *filecontent = 0;
    \textcolor{keywordtype}{size\_t} result;
    running = 0;

    FILE *fp = fopen(file->filename, \textcolor{stringliteral}{"rb"});
    \textcolor{keywordflow}{if} (fp)
    \{
        fseek(fp , 0 , SEEK\_END);
        filesize = ftell(fp);
        rewind(fp);
        filecontent = (\textcolor{keywordtype}{char}*) malloc(filesize+1);
        \textcolor{keywordflow}{if} (!filecontent)
        \{
            fclose(fp);
            printf(\textcolor{stringliteral}{"malloc error\(\backslash\)n"});
            \textcolor{keywordflow}{return};
        \}

        result = fread(filecontent, 1, filesize, fp);
        \textcolor{keywordflow}{if} (result != filesize)
        \{
            fclose(fp);
            printf(\textcolor{stringliteral}{"file read failed\(\backslash\)n"});
            \textcolor{keywordflow}{return};
        \}
        filecontent[filesize] = 0;
        printf(\textcolor{stringliteral}{"%s changed!\(\backslash\)nnew file content:\(\backslash\)n%s\(\backslash\)n"}, file->filename, filecontent);
        free(filecontent);
        fclose(fp);
    \}
\}

\textcolor{keywordtype}{int} main(\textcolor{keywordtype}{int} argc, \textcolor{keywordtype}{char} **argv)
\{
    \hyperlink{gai__hotreload_8h_structgaihr__file}{gaihr\_file} MyFile = \{\};
    \hyperlink{gai__hotreload_8h_ad83d8f6170f0404fb72803d012ac9f6a}{gaihr\_Track}(&MyFile, \textcolor{stringliteral}{"testfile.txt"}, printFileContentAndStop, 0, 
      \hyperlink{gai__hotreload_8h_aaebb069b6896f065efd75640e0e4150baee50ce1492a508e5605592106fa00bd5}{gaihr\_FlagsSkipInitialChange});
    printf(\textcolor{stringliteral}{"Please change the file content or replace the file now...\(\backslash\)n"});
    \textcolor{keywordflow}{while} (running) \{Sleep(125);\}
    \textcolor{keywordflow}{return} 0;
\}
\end{DoxyCodeInclude}
 